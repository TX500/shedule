From 51780d78b58c3e568549e47321d031532f0925fe Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?=D0=9D=D0=BE=D1=83=D1=82=D0=B1=D1=83=D0=BA?= <mail@gf.com>
Date: Tue, 5 Jan 2021 21:40:42 +0300
Subject: [PATCH] =?UTF-8?q?=D1=82=D0=B5=D1=85=D0=BD=D0=B8=D1=87=D0=B5?=
 =?UTF-8?q?=D1=81=D0=BA=D0=B0=D1=8F=20=D0=B4=D0=BE=D0=B1=D1=80=D0=BE=D1=81?=
 =?UTF-8?q?=D0=BA=D0=B0=202?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

---
 Shedule_04/DB.cs                        |  4 +-
 Shedule_04/Query/Create.sql             | 11 ++++-
 Shedule_04/Query/INSERT.sql             | 17 +++++---
 Shedule_04/Query/SQLQuery1.sql          |  3 +-
 Shedule_04/SheduleForm.Designer.cs      | 50 +++++++++++++--------
 Shedule_04/SheduleForm.cs               | 58 ++++++++++++++++++++++---
 Shedule_04/SheduleForm.resx             |  9 ++--
 Shedule_04/SheduleGroupForm.Designer.cs | 54 ++++++++++++++---------
 Shedule_04/SheduleGroupForm.cs          | 11 +++++
 9 files changed, 159 insertions(+), 58 deletions(-)

diff --git a/Shedule_04/DB.cs b/Shedule_04/DB.cs
index 2d5ee44..0210d60 100644
--- a/Shedule_04/DB.cs
+++ b/Shedule_04/DB.cs
@@ -8,6 +8,8 @@ namespace Shedule_04
 {
     class DB
     {
-        public static string connectString = @"Integrated Security=false; User Id = root; Password = root; Initial Catalog = shedule; server = DESKTOP-80LGH2G\SQLEXPRESS";
+        //public static string connectString = @"Integrated Security=false; User Id = root; Password = root; Initial Catalog = shedule; server = DESKTOP-80LGH2G\SQLEXPRESS";
+        public static string connectString = @"Integrated Security=false; User Id = root; Password = root; Initial Catalog = shedule; server = DESKTOP-R35231Q\MYDB";
+
     }
 }
diff --git a/Shedule_04/Query/Create.sql b/Shedule_04/Query/Create.sql
index 765200c..df2e33f 100644
--- a/Shedule_04/Query/Create.sql
+++ b/Shedule_04/Query/Create.sql
@@ -1,4 +1,4 @@
-DROP TABLE IF EXISTS groups, faculty, subject, classroom, lecturer, shedule, shedule_time;
+DROP TABLE IF EXISTS groups, faculty, subject, classroom, lecturer, shedule, shedule_time, shedule_table;
 
 CREATE TABLE faculty (
 	id_faculty bigint NOT NULL IDENTITY, 
@@ -36,7 +36,7 @@ CREATE TABLE lecturer (
 
 CREATE TABLE shedule_time(
 	id_shTime bigint NOT NULL IDENTITY,
-	fk_group bigint FOREIGN KEY REFERENCES groups (id_group),
+	--fk_group bigint FOREIGN KEY REFERENCES groups (id_group),
 	day varchar(255) NOT NULL,
 	task_number integer NOT NULL,
 	fk_subject bigint FOREIGN KEY REFERENCES subject (id_subject),
@@ -44,3 +44,10 @@ CREATE TABLE shedule_time(
 	fk_lecturer bigint FOREIGN KEY REFERENCES lecturer (id_lecturer),
 	primary key (id_shTime)
 );
+CREATE TABLE shedule_table(
+	id_shTable bigint NOT NULL IDENTITY,
+	fk_group bigint FOREIGN KEY REFERENCES groups (id_group),
+	shed_time bigint FOREIGN KEY REFERENCES shedule_time (id_shTime),
+	semester varchar(255) NOT NULL,
+	year varchar(255) NOT NULL,
+	primary key (id_shTable));
diff --git a/Shedule_04/Query/INSERT.sql b/Shedule_04/Query/INSERT.sql
index d4d6397..0983262 100644
--- a/Shedule_04/Query/INSERT.sql
+++ b/Shedule_04/Query/INSERT.sql
@@ -75,8 +75,15 @@ INSERT INTO subject(subject_name) VALUES
 
 
 
-INSERT INTO shedule_time (day, fk_group, task_number, fk_subject, fk_classroom, fk_lecturer) VALUES
-	('Понедельник', '1', '1', '1', '1', '1'),
-	('Понедельник', '1', '2', '2', '2', '2'),
-	('Понедельник', '1', '3', '3', '10', '3'),
-	('Понедельник', '1', '4', '4', '11', '4');
+INSERT INTO shedule_time (day, task_number, fk_subject, fk_classroom, fk_lecturer) VALUES
+	('Понедельник', '1',  '1', '1', '1'),
+	('Понедельник', '1',  '2', '2', '2'),
+	('Понедельник', '1',  '3', '10', '3'),
+	('Понедельник', '1',  '4', '11', '4');
+
+INSERT INTO shedule_table (fk_group, shed_time, semester, year) VALUES
+	('1', '1',  '1', '2020/2021'),
+	('1', '2',  '1', '2020/2021'),
+	('2', '3',  '1', '2020/2021'),
+	('2', '4',  '1', '2020/2021');
+
diff --git a/Shedule_04/Query/SQLQuery1.sql b/Shedule_04/Query/SQLQuery1.sql
index bef7f07..330ec4d 100644
--- a/Shedule_04/Query/SQLQuery1.sql
+++ b/Shedule_04/Query/SQLQuery1.sql
@@ -1,4 +1,5 @@
-select task_number, subject_name, classroom_name, surname
+/*select task_number, subject_name, classroom_name, surname
 from shedule_time, subject, classroom, lecturer
 where day = 'Понедельник' AND fk_subject = id_subject AND fk_classroom = id_classroom AND fk_lecturer = id_lecturer;
+*/
 
diff --git a/Shedule_04/SheduleForm.Designer.cs b/Shedule_04/SheduleForm.Designer.cs
index bb2c637..b548e86 100644
--- a/Shedule_04/SheduleForm.Designer.cs
+++ b/Shedule_04/SheduleForm.Designer.cs
@@ -34,10 +34,11 @@
             this.addLink = new System.Windows.Forms.LinkLabel();
             this.nameForm = new System.Windows.Forms.Label();
             this.dataGridView1 = new System.Windows.Forms.DataGridView();
-            this.Column1 = new System.Windows.Forms.DataGridViewTextBoxColumn();
+            this.Column5 = new System.Windows.Forms.DataGridViewTextBoxColumn();
             this.Column2 = new System.Windows.Forms.DataGridViewTextBoxColumn();
-            this.Column3 = new System.Windows.Forms.DataGridViewTextBoxColumn();
             this.Column4 = new System.Windows.Forms.DataGridViewTextBoxColumn();
+            this.Column1 = new System.Windows.Forms.DataGridViewTextBoxColumn();
+            this.Column3 = new System.Windows.Forms.DataGridViewTextBoxColumn();
             this.panelUp.SuspendLayout();
             ((System.ComponentModel.ISupportInitialize)(this.dataGridView1)).BeginInit();
             this.SuspendLayout();
@@ -111,25 +112,28 @@
             this.dataGridView1.AllowUserToDeleteRows = false;
             this.dataGridView1.ColumnHeadersHeightSizeMode = System.Windows.Forms.DataGridViewColumnHeadersHeightSizeMode.AutoSize;
             this.dataGridView1.Columns.AddRange(new System.Windows.Forms.DataGridViewColumn[] {
-            this.Column1,
+            this.Column5,
             this.Column2,
-            this.Column3,
-            this.Column4});
+            this.Column4,
+            this.Column1,
+            this.Column3});
             this.dataGridView1.Dock = System.Windows.Forms.DockStyle.Fill;
             this.dataGridView1.Location = new System.Drawing.Point(0, 45);
             this.dataGridView1.Name = "dataGridView1";
             this.dataGridView1.ReadOnly = true;
             this.dataGridView1.RowHeadersVisible = false;
+            this.dataGridView1.SelectionMode = System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect;
             this.dataGridView1.Size = new System.Drawing.Size(806, 407);
             this.dataGridView1.TabIndex = 2;
+            this.dataGridView1.CellDoubleClick += new System.Windows.Forms.DataGridViewCellEventHandler(this.dataGridView1_CellDoubleClick);
             // 
-            // Column1
+            // Column5
             // 
-            this.Column1.Frozen = true;
-            this.Column1.HeaderText = "id_row";
-            this.Column1.Name = "Column1";
-            this.Column1.ReadOnly = true;
-            this.Column1.Visible = false;
+            this.Column5.Frozen = true;
+            this.Column5.HeaderText = "id_row";
+            this.Column5.Name = "Column5";
+            this.Column5.ReadOnly = true;
+            this.Column5.Visible = false;
             // 
             // Column2
             // 
@@ -138,18 +142,24 @@
             this.Column2.Name = "Column2";
             this.Column2.ReadOnly = true;
             // 
-            // Column3
-            // 
-            this.Column3.HeaderText = "РџРµСЂРёРѕРґ";
-            this.Column3.Name = "Column3";
-            this.Column3.ReadOnly = true;
-            // 
             // Column4
             // 
             this.Column4.HeaderText = "Р“СЂСѓРїРїР°";
             this.Column4.Name = "Column4";
             this.Column4.ReadOnly = true;
             // 
+            // Column1
+            // 
+            this.Column1.HeaderText = "РЎРµРјРµСЃС‚СЂ";
+            this.Column1.Name = "Column1";
+            this.Column1.ReadOnly = true;
+            // 
+            // Column3
+            // 
+            this.Column3.HeaderText = "Р“РѕРґ";
+            this.Column3.Name = "Column3";
+            this.Column3.ReadOnly = true;
+            // 
             // SheduleForm
             // 
             this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F);
@@ -163,6 +173,7 @@
             this.StartPosition = System.Windows.Forms.FormStartPosition.CenterParent;
             this.Text = "Р Р°СЃРїРёСЃР°РЅРёСЏ";
             this.WindowState = System.Windows.Forms.FormWindowState.Maximized;
+            this.Load += new System.EventHandler(this.SheduleForm_Load);
             this.panelUp.ResumeLayout(false);
             this.panelUp.PerformLayout();
             ((System.ComponentModel.ISupportInitialize)(this.dataGridView1)).EndInit();
@@ -178,9 +189,10 @@
         private System.Windows.Forms.LinkLabel addLink;
         private System.Windows.Forms.Label nameForm;
         private System.Windows.Forms.DataGridView dataGridView1;
-        private System.Windows.Forms.DataGridViewTextBoxColumn Column1;
+        private System.Windows.Forms.DataGridViewTextBoxColumn Column5;
         private System.Windows.Forms.DataGridViewTextBoxColumn Column2;
-        private System.Windows.Forms.DataGridViewTextBoxColumn Column3;
         private System.Windows.Forms.DataGridViewTextBoxColumn Column4;
+        private System.Windows.Forms.DataGridViewTextBoxColumn Column1;
+        private System.Windows.Forms.DataGridViewTextBoxColumn Column3;
     }
 }
\ No newline at end of file
diff --git a/Shedule_04/SheduleForm.cs b/Shedule_04/SheduleForm.cs
index a58bce3..6495ad1 100644
--- a/Shedule_04/SheduleForm.cs
+++ b/Shedule_04/SheduleForm.cs
@@ -1,20 +1,64 @@
 п»їusing System;
-using System.Collections.Generic;
-using System.ComponentModel;
-using System.Data;
-using System.Drawing;
-using System.Linq;
-using System.Text;
-using System.Threading.Tasks;
+using System.Data.SqlClient;
 using System.Windows.Forms;
 
 namespace Shedule_04
 {
     public partial class SheduleForm : Form
     {
+
         public SheduleForm()
         {
             InitializeComponent();
         }
+        SqlConnection connect = new SqlConnection(DB.connectString);
+        private void SheduleForm_Load(object sender, EventArgs e)
+        {
+            tableLoad();
+        }
+
+        private void tableLoad()
+        {
+            string querieAll = @"SELECT g.group_name, sh.semester, sh.year
+
+  FROM shedule_table sh join  groups g on sh.fk_group=g.id_group
+  group by g.group_name, sh.semester, sh.year;";
+
+            SqlCommand table = new SqlCommand(querieAll, connect);
+
+            connect.Open();
+
+            SqlDataReader reader = table.ExecuteReader();
+
+            int i = 0;
+            int N = 1;
+            dataGridView1.Rows.Clear();
+
+            while (reader.Read())
+            {
+                dataGridView1.Rows.Add();
+                //dataGridView1[0, i].Value = reader[0];    // id
+                dataGridView1[0, i].Value = N;
+                dataGridView1[1, i].Value = reader[0];    //group        
+                dataGridView1[2, i].Value = reader[1];    // semester
+                dataGridView1[3, i].Value = reader[2];    // year
+                i++;
+                N++;
+            }
+            reader.Close();
+            connect.Close();
+        }
+
+        private void dataGridView1_CellDoubleClick(object sender, DataGridViewCellEventArgs e)
+        {
+            int row = dataGridView1.CurrentRow.Index;
+            SheduleGroupForm shg = new SheduleGroupForm();
+
+            shg.group = dataGridView1[1, row].Value.ToString();
+            shg.semester = dataGridView1[2, row].Value.ToString();
+            shg.year = dataGridView1[3, row].Value.ToString();
+
+            shg.ShowDialog();
+        }
     }
 }
diff --git a/Shedule_04/SheduleForm.resx b/Shedule_04/SheduleForm.resx
index 1d910af..faceea0 100644
--- a/Shedule_04/SheduleForm.resx
+++ b/Shedule_04/SheduleForm.resx
@@ -117,16 +117,19 @@
   <resheader name="writer">
     <value>System.Resources.ResXResourceWriter, System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089</value>
   </resheader>
-  <metadata name="Column1.UserAddedColumn" type="System.Boolean, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
+  <metadata name="Column5.UserAddedColumn" type="System.Boolean, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
     <value>True</value>
   </metadata>
   <metadata name="Column2.UserAddedColumn" type="System.Boolean, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
     <value>True</value>
   </metadata>
-  <metadata name="Column3.UserAddedColumn" type="System.Boolean, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
+  <metadata name="Column4.UserAddedColumn" type="System.Boolean, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
     <value>True</value>
   </metadata>
-  <metadata name="Column4.UserAddedColumn" type="System.Boolean, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
+  <metadata name="Column1.UserAddedColumn" type="System.Boolean, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
+    <value>True</value>
+  </metadata>
+  <metadata name="Column3.UserAddedColumn" type="System.Boolean, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089">
     <value>True</value>
   </metadata>
 </root>
\ No newline at end of file
diff --git a/Shedule_04/SheduleGroupForm.Designer.cs b/Shedule_04/SheduleGroupForm.Designer.cs
index c584b86..688d0f1 100644
--- a/Shedule_04/SheduleGroupForm.Designer.cs
+++ b/Shedule_04/SheduleGroupForm.Designer.cs
@@ -46,8 +46,10 @@
             this.comboBox3 = new System.Windows.Forms.ComboBox();
             this.label4 = new System.Windows.Forms.Label();
             this.comboBox4 = new System.Windows.Forms.ComboBox();
+            this.panel1 = new System.Windows.Forms.Panel();
             this.panelUp.SuspendLayout();
             ((System.ComponentModel.ISupportInitialize)(this.dataGridView1)).BeginInit();
+            this.panel1.SuspendLayout();
             this.SuspendLayout();
             // 
             // panelUp
@@ -60,7 +62,7 @@
             this.panelUp.Dock = System.Windows.Forms.DockStyle.Top;
             this.panelUp.Location = new System.Drawing.Point(0, 0);
             this.panelUp.Name = "panelUp";
-            this.panelUp.Size = new System.Drawing.Size(1125, 45);
+            this.panelUp.Size = new System.Drawing.Size(1007, 45);
             this.panelUp.TabIndex = 2;
             // 
             // deleteLink
@@ -127,7 +129,7 @@
             this.dataGridView1.Location = new System.Drawing.Point(0, 45);
             this.dataGridView1.Name = "dataGridView1";
             this.dataGridView1.ReadOnly = true;
-            this.dataGridView1.Size = new System.Drawing.Size(759, 603);
+            this.dataGridView1.Size = new System.Drawing.Size(638, 465);
             this.dataGridView1.TabIndex = 3;
             // 
             // Column1
@@ -162,7 +164,7 @@
             // 
             this.comboBox1.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
             this.comboBox1.FormattingEnabled = true;
-            this.comboBox1.Location = new System.Drawing.Point(902, 154);
+            this.comboBox1.Location = new System.Drawing.Point(159, 124);
             this.comboBox1.Name = "comboBox1";
             this.comboBox1.Size = new System.Drawing.Size(121, 21);
             this.comboBox1.TabIndex = 4;
@@ -170,7 +172,7 @@
             // label1
             // 
             this.label1.AutoSize = true;
-            this.label1.Location = new System.Drawing.Point(810, 157);
+            this.label1.Location = new System.Drawing.Point(67, 127);
             this.label1.Name = "label1";
             this.label1.Size = new System.Drawing.Size(26, 13);
             this.label1.TabIndex = 5;
@@ -179,7 +181,7 @@
             // label2
             // 
             this.label2.AutoSize = true;
-            this.label2.Location = new System.Drawing.Point(810, 200);
+            this.label2.Location = new System.Drawing.Point(67, 170);
             this.label2.Name = "label2";
             this.label2.Size = new System.Drawing.Size(41, 13);
             this.label2.TabIndex = 7;
@@ -189,7 +191,7 @@
             // 
             this.comboBox2.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
             this.comboBox2.FormattingEnabled = true;
-            this.comboBox2.Location = new System.Drawing.Point(902, 197);
+            this.comboBox2.Location = new System.Drawing.Point(159, 167);
             this.comboBox2.Name = "comboBox2";
             this.comboBox2.Size = new System.Drawing.Size(121, 21);
             this.comboBox2.TabIndex = 6;
@@ -197,7 +199,7 @@
             // label3
             // 
             this.label3.AutoSize = true;
-            this.label3.Location = new System.Drawing.Point(810, 301);
+            this.label3.Location = new System.Drawing.Point(67, 271);
             this.label3.Name = "label3";
             this.label3.Size = new System.Drawing.Size(54, 13);
             this.label3.TabIndex = 11;
@@ -207,7 +209,7 @@
             // 
             this.comboBox3.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
             this.comboBox3.FormattingEnabled = true;
-            this.comboBox3.Location = new System.Drawing.Point(902, 298);
+            this.comboBox3.Location = new System.Drawing.Point(159, 268);
             this.comboBox3.Name = "comboBox3";
             this.comboBox3.Size = new System.Drawing.Size(121, 21);
             this.comboBox3.TabIndex = 10;
@@ -215,7 +217,7 @@
             // label4
             // 
             this.label4.AutoSize = true;
-            this.label4.Location = new System.Drawing.Point(810, 258);
+            this.label4.Location = new System.Drawing.Point(67, 228);
             this.label4.Name = "label4";
             this.label4.Size = new System.Drawing.Size(42, 13);
             this.label4.TabIndex = 9;
@@ -225,24 +227,34 @@
             // 
             this.comboBox4.DropDownStyle = System.Windows.Forms.ComboBoxStyle.DropDownList;
             this.comboBox4.FormattingEnabled = true;
-            this.comboBox4.Location = new System.Drawing.Point(902, 255);
+            this.comboBox4.Location = new System.Drawing.Point(159, 225);
             this.comboBox4.Name = "comboBox4";
             this.comboBox4.Size = new System.Drawing.Size(121, 21);
             this.comboBox4.TabIndex = 8;
             // 
+            // panel1
+            // 
+            this.panel1.BackColor = System.Drawing.SystemColors.ButtonHighlight;
+            this.panel1.Controls.Add(this.comboBox3);
+            this.panel1.Controls.Add(this.label3);
+            this.panel1.Controls.Add(this.comboBox1);
+            this.panel1.Controls.Add(this.label1);
+            this.panel1.Controls.Add(this.label4);
+            this.panel1.Controls.Add(this.comboBox2);
+            this.panel1.Controls.Add(this.comboBox4);
+            this.panel1.Controls.Add(this.label2);
+            this.panel1.Dock = System.Windows.Forms.DockStyle.Right;
+            this.panel1.Location = new System.Drawing.Point(630, 45);
+            this.panel1.Name = "panel1";
+            this.panel1.Size = new System.Drawing.Size(377, 465);
+            this.panel1.TabIndex = 12;
+            // 
             // SheduleGroupForm
             // 
             this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F);
             this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
-            this.ClientSize = new System.Drawing.Size(1125, 648);
-            this.Controls.Add(this.label3);
-            this.Controls.Add(this.comboBox3);
-            this.Controls.Add(this.label4);
-            this.Controls.Add(this.comboBox4);
-            this.Controls.Add(this.label2);
-            this.Controls.Add(this.comboBox2);
-            this.Controls.Add(this.label1);
-            this.Controls.Add(this.comboBox1);
+            this.ClientSize = new System.Drawing.Size(1007, 510);
+            this.Controls.Add(this.panel1);
             this.Controls.Add(this.dataGridView1);
             this.Controls.Add(this.panelUp);
             this.Name = "SheduleGroupForm";
@@ -250,8 +262,9 @@
             this.panelUp.ResumeLayout(false);
             this.panelUp.PerformLayout();
             ((System.ComponentModel.ISupportInitialize)(this.dataGridView1)).EndInit();
+            this.panel1.ResumeLayout(false);
+            this.panel1.PerformLayout();
             this.ResumeLayout(false);
-            this.PerformLayout();
 
         }
 
@@ -275,5 +288,6 @@
         private System.Windows.Forms.ComboBox comboBox3;
         private System.Windows.Forms.Label label4;
         private System.Windows.Forms.ComboBox comboBox4;
+        private System.Windows.Forms.Panel panel1;
     }
 }
\ No newline at end of file
diff --git a/Shedule_04/SheduleGroupForm.cs b/Shedule_04/SheduleGroupForm.cs
index 5095f71..579e951 100644
--- a/Shedule_04/SheduleGroupForm.cs
+++ b/Shedule_04/SheduleGroupForm.cs
@@ -12,9 +12,20 @@ namespace Shedule_04
 {
     public partial class SheduleGroupForm : Form
     {
+        public String group;
+        public String semester;
+        public String year;
+        
+        
+        
         public SheduleGroupForm()
         {
             InitializeComponent();
         }
+
+        // РџРѕР»СѓС‡Р°РµРј РР” РіСЂСѓРїРїС‹
+        // РћС‚Р±РёСЂР°РІРµРј РІСЃРµ РР” РєРІР°РЅС‚РѕРІ Рё Р·Р°СЃРѕРІС‹РІР°РµРј РёС… РІ Р›РРЎРў
+        // Р—Р°РїРѕР»РЅСЏРµРј С‚Р°Р±Р»РёС†Сѓ РёС… РР” РІ Р»РёСЃС‚Рµ
+
     }
 }
-- 
2.26.2.windows.1

